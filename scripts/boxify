#!/bin/bash

function boxify {
	max_length='0'
	# Fixing files with no terminal newline
	# Source: https://stackoverflow.com/a/12916758
	while IFS= read -r line || [ -n "$line" ]
	do
		this_length=$(($(echo "$line" | wc -m) - 1))
		if [ "$this_length" -gt "$max_length" ]; then
			max_length="$this_length"
		fi
	# Guard against empty input using printf
	done <<< $(printf '%s\n' "$@")

	# ┌─────────╖
	printf '┌─'
	printf "%${max_length}s" '' | sed 's/ /─/g'
	printf '─╖\n'

	while IFS= read -r line || [ -n "$line" ]
	do
		case "$line" in
			# ├─────────╢
			'---')
				printf '├─'
				printf "%${max_length}s" '' | sed 's/ /─/g'
				printf '─╢\n'
				;;
			# ╞═════════╣
			'===')
				printf '╞═'
				printf "%${max_length}s" '' | sed 's/ /═/g'
				printf '═╣\n'
				;;
			# │ Example ║
			*)
				this_length=$(($(echo "$line" | wc -m) - 1))
				needed=$(( "${max_length}" - "${this_length}" ))
				printf "│ %s%${needed}s ║\n" "${line}" ''
				;;
		esac
	done <<< $(printf '%s\n' "$@")

	# ╘═════════╝
	printf '╘═'
	printf "%${max_length}s" '' | sed 's/ /═/g'
	printf '═╝\n'
}

# $ boxify 'a' 'bbbb' '---' 'c' '    d' '===' 'f'
# ┌────────╖
# │ a      ║
# │ bbbb   ║
# ├────────╢
# │ c      ║
# │     d  ║
# ╞════════╣
# │ f      ║
# ╘════════╝

boxify "$@"
